class i{constructor(i,t){this.x=i,this.y=t}distance(i){return Math.sqrt(Math.pow(this.x-i.x,2)+Math.pow(this.y-i.y,2))}}class t{constructor(t,s,e,o,h,n,a){this.position=t,this.targetX=t.x,this.scale=s,this.targetScale=new i(s.x,s.y),this.speed=e,this.juiceSpeed=o,this.juiceScale=h,this.paddleXFriction=n,this.paddleFollowRatio=a,this.velocity=new i(0,0),this.dragging=!1}update(i){if(this.dragging){const i=u.y-.5*this.scale.y;this.withinYBounds(i)&&(this.position.y=i)}else this.follow(i);this.position.x+=this.velocity.x,this.velocity.x*=this.paddleXFriction,this.lerpXPositionToTarget(),this.lerpScaleToTarget()}hasMouseHovering(){const i=.25*this.scale.y;return u.x>this.position.x-this.scale.x&&u.x<this.position.x+2*this.scale.x&&u.y>this.position.y-i&&u.y<this.position.y+this.scale.y+i}handleHover(){if(document.body.style.cursor=a,d.style.zIndex=n,y){const i=.25*this.scale.x;this.scale.x*=this.juiceScale,this.scale.y*=this.juiceScale,this.position.x-=i,document.body.style.cursor=l,this.dragging=!0}}lerpXPositionToTarget(){this.position.x+=(this.targetX-this.position.x)*this.juiceSpeed/o}lerpScaleToTarget(){this.scale.x+=(this.targetScale.x-this.scale.x)*this.juiceSpeed/o,this.scale.y+=(this.targetScale.y-this.scale.y)*this.juiceSpeed/o}follow(i){if(this.position.distance(i.position)>d.width*this.paddleFollowRatio)return;const t=this.position.y+.5*this.scale.y,s=this.position.y+(i.position.y-t)*this.speed/o;this.withinYBounds(s)&&(this.position.y=s)}withinYBounds(i){return i>=0&&i<=d.height-this.scale.y}draw(){var i,t,s,e,o;i=this.position.x,t=this.position.y,s=this.scale.x,e=this.scale.y,o=r,c.beginPath(),c.moveTo(i+o,t),c.lineTo(i+s-o,t),c.quadraticCurveTo(i+s,t,i+s,t+o),c.lineTo(i+s,t+e-o),c.quadraticCurveTo(i+s,t+e,i+s-o,t+e),c.lineTo(i+o,t+e),c.quadraticCurveTo(i,t+e,i,t+e-o),c.lineTo(i,t+o),c.quadraticCurveTo(i,t,i+o,t),c.closePath(),c.fill()}}class s{constructor(t){if(this.particles=new Array(t),t<1)throw new Error("Trail length must be greater than 0");for(let s=0;s<t;++s)this.particles[s]=new e(new i(0,0),0)}add(i,t,s){this.particles.unshift(this.particles.pop());const e=this.particles[0];e.position.x=i,e.position.y=t,e.radius=s}}class e{constructor(i,t){this.position=i,this.radius=t}}const o=60,h=1e3/o,n="1",a="grab",l="none",r=5,d=document.createElement("canvas");d.id="jongler",d.width=window.innerWidth,d.height=window.innerHeight,document.body.appendChild(d);const c=d.getContext("2d");let p=Date.now();const u=new i(0,0);let y=!1;const g=new t(new i(40,0),new i(25,120),10,4,1.5,.8,.6),w=new t(new i(d.width-25-40,0),new i(25,120),10,4,1.5,.8,.6),x=new class{constructor(i,t,e,o,h,n,a,l,r,d,c,p,u,y){this.position=i,this.velocity=t,this.radius=e,this.speed=o,this.initialSpeed=o,this.speedLimit=h,this.collisionSpeed=n,this.collisionVelocityScalar=a,this.collisionAngleRandomness=l,this.friction=r,this.minRandomAngleConstraint=d,this.maxRandomAngleConstraint=c,this.trailDriftSpeed=p,this.trailSize=u,this.trailDissolutionRate=y,this.trail=new s(this.trailSize),this.lastCollisionTime=0,this.init()}init(){this.speed=this.initialSpeed,this.setInitialPosition(),this.setRandomVelocity()}setInitialPosition(){this.position=new i(d.width/2,d.height/2)}setRandomVelocity(){const i=(t=this.minRandomAngleConstraint,((this.maxRandomAngleConstraint-t)*Math.random()+t)/180*Math.PI);var t;this.velocity.x=Math.sign(Math.random()-.5)*Math.cos(i)*this.speed,this.velocity.y=-Math.sin(i)*this.speed}update(i){this.updateSpeed(),this.collidesWithTop()?(this.velocity.y=-this.velocity.y,this.position.y+=2*this.radius):this.collidesWithBottom()&&(this.velocity.y=-this.velocity.y,this.position.y-=2*this.radius);for(const t of i)this.collidesWithPaddle(t)&&(this.updateVelocityFromCollision(t),this.lastCollisionTime=Date.now());if((this.collidesWithLeft()||this.collidesWithRight())&&this.init(),this.lastCollisionTime+this.speed>Date.now())this.trail.add(this.position.x,this.position.y,this.radius);else for(const i of this.trail.particles)i.position.y+=this.trailDriftSpeed/o;for(const i of this.trail.particles)i.radius*=this.trailDissolutionRate;this.updatePosition()}updateSpeed(){this.speed*=this.friction,this.speed=Math.max(this.speed,this.initialSpeed),this.speed=Math.min(this.speed,this.speedLimit)}updatePosition(){this.position.x+=this.velocity.x/o,this.position.y+=this.velocity.y/o}updateVelocityFromCollision(i){let t=(i.position.y+.5*i.scale.y-this.position.y)*Math.PI/i.scale.y*.5;t+=Math.sign(t)*Math.random()*this.collisionAngleRandomness,this.speed+=this.collisionSpeed,this.velocity.x=Math.sign(-this.velocity.x)*Math.cos(t)*this.speed,this.velocity.y=-Math.sin(t)*this.speed,this.position.x+=Math.sign(this.velocity.x)*this.radius,this.position.y+=Math.sign(this.velocity.y)*this.radius,i.velocity.x=-Math.sign(x.velocity.x)*Math.abs(x.velocity.x)*this.collisionVelocityScalar/o}collidesWithPaddle(i){const{position:t,scale:s}=i;return this.position.x+this.radius>t.x&&this.position.x-this.radius<t.x+s.x&&this.position.y+this.radius>t.y&&this.position.y-this.radius<t.y+s.y}collidesWithTop(){return this.position.y-this.radius<0}collidesWithBottom(){return this.position.y+this.radius>d.height}collidesWithLeft(){return this.position.x+this.radius<0}collidesWithRight(){return this.position.x-this.radius>d.width}draw(){f(this.position.x,this.position.y,this.radius);for(const i of this.trail.particles)f(i.position.x,i.position.y,i.radius)}}(new i(0,0),new i(0,0),10,800,1600,100,.45,.1,.9998,-45,45,100,20,.94);function f(i,t,s){c.beginPath(),c.arc(i,t,s,0,2*Math.PI,!0),c.closePath(),c.fill()}!function i(){self.requestAnimationFrame(i);const t=Date.now(),s=t-p;if(s<=h)return;if(p=t-s%h,c.clearRect(0,0,d.width,d.height),function(){return d.width<=1024||d.height<=768}())return;x.update([g,w]),g.update(x),w.update(x),function(){y||(g.dragging=w.dragging=!1);const i=!g.dragging&&!w.dragging,t=g.hasMouseHovering(),s=w.hasMouseHovering();i&&(t?g.handleHover():s&&w.handleHover()),t||s||y||(d.style.zIndex=document.body.style.cursor="")}(),function(i){(function(i){c.fillStyle=function(i,t,s,e,h){const n=c.createLinearGradient(i,t,s,e),a=.2*Math.cos(.25*h/o);return n.addColorStop(0,"#0099ff"),n.addColorStop(a+.25,"#19ff5a"),n.addColorStop(a+.5,"#ffcb0d"),n.addColorStop(a+.75,"#ff9600"),n.addColorStop(1,"#ff1b19"),n}(0,0,d.width,d.height,i)})(i),g.draw(),w.draw(),x.draw()}(t)}(),self.addEventListener("resize",(()=>{const i=d.width;d.width=window.innerWidth,d.height=window.innerHeight,x.position.x+=d.width-i,w.targetX=w.position.x=d.width-25-40})),self.addEventListener("mousemove",(i=>{u.x=i.clientX,u.y=i.clientY})),self.addEventListener("mousedown",(()=>{y=!0})),self.addEventListener("mouseup",(()=>{y=!1}));